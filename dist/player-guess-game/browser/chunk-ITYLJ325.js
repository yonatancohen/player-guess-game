import{a as Q,b as R}from"./chunk-IROAERGP.js";import{b as g,c as B}from"./chunk-M4HWW2TT.js";import{b as O}from"./chunk-5XF2VKTD.js";import{A as M,C as j,D as G,E as L,F as q,m as I,q as A,r as s,s as N,t as T,x as k,z as V}from"./chunk-J5QQIEZR.js";import"./chunk-UISL6Y2D.js";import{Db as a,Eb as i,Ec as F,Fb as d,Jc as P,Lb as h,Mb as p,Rb as D,Sb as C,Tb as S,Vb as m,Xb as c,_a as n,ac as w,eb as y,g as b,h as x,jb as E,ob as u,qa as v,vb as l,w as _}from"./chunk-UX2FJVH3.js";var U=t=>["/",t,"games"];function J(t,r){if(t&1&&(a(0,"span",22),m(1),i()),t&2){let e=p();n(),c(" ",e.getFormControlError("first_name_he")," ")}}function K(t,r){if(t&1&&(a(0,"span",22),m(1),i()),t&2){let e=p();n(),c(" ",e.getFormControlError("last_name_he")," ")}}function W(t,r){if(t&1&&(a(0,"span",22),m(1),i()),t&2){let e=p();n(),c(" ",e.getFormControlError("display_name_he")," ")}}function X(t,r){if(t&1&&(a(0,"span",22),m(1),i()),t&2){let e=p();n(),c(" ",e.getFormControlError("nationality_id")," ")}}function Y(t,r){t&1&&(v(),a(0,"svg",23),d(1,"circle",24)(2,"path",25),i())}var z=class t{constructor(r,e,o){this.adminService=r;this.fb=e;this.toastrService=o;this.playerForm=this.fb.group({first_name_he:[null,[s.required,s.minLength(2)]],last_name_he:[null,[s.required,s.minLength(2)]],display_name_he:[null,[s.required,s.minLength(2)]],nationality_id:[null,s.required]})}subs=new x;autoCompleteComponent;countries=[];selectedPlayer;submitting=!1;environment=q;playerForm;ngOnInit(){this.subs.add(this.adminService.getCountries().subscribe(r=>this.countries=r))}ngOnDestroy(){this.subs.unsubscribe()}onPlayerSelected(r){return b(this,null,function*(){this.selectedPlayer=r;let e=yield _(this.adminService.getPlayer(r.id));this.playerForm.patchValue(e)})}getFormControlError(r){let e=this.playerForm.get(r);if(e?.invalid&&(e?.dirty||e?.touched)){if(e?.errors?.required)return"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4";if(e?.errors?.minlength)return"\u05DE\u05D9\u05E0\u05D9\u05DE\u05D5\u05DD 2 \u05EA\u05D5\u05D5\u05D9\u05DD";if(e?.errors?.min)return"\u05DE\u05E1\u05E4\u05E8 \u05D7\u05D9\u05D5\u05D1\u05D9 \u05D1\u05DC\u05D1\u05D3";if(e?.errors?.max)return"\u05DE\u05E1\u05E4\u05E8 \u05E2\u05D3 99"}return""}onSubmit(){if(this.playerForm.markAllAsTouched(),this.playerForm.valid&&this.selectedPlayer){this.submitting=!0;let r=this.playerForm.value;this.adminService.updatePlayer(this.selectedPlayer.id,r).subscribe({next:()=>{this.submitting=!1,this.toastrService.success("\u05D4\u05E9\u05D7\u05E7\u05DF \u05E2\u05D5\u05D3\u05DB\u05DF \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4"),this.playerForm.reset(),this.playerForm.markAsPristine(),this.playerForm.markAsUntouched(),this.playerForm.updateValueAndValidity(),this.autoCompleteComponent.resetSelection(),this.selectedPlayer=void 0},error:()=>{this.submitting=!1,this.toastrService.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E2\u05D3\u05DB\u05D5\u05DF \u05D4\u05E9\u05D7\u05E7\u05DF")}})}}static \u0275fac=function(e){return new(e||t)(y(O),y(j),y(B))};static \u0275cmp=E({type:t,selectors:[["app-edit-player"]],viewQuery:function(e,o){if(e&1&&D(g,5),e&2){let f;C(f=S())&&(o.autoCompleteComponent=f.first)}},decls:36,vars:16,consts:[[1,"min-h-screen","bg-gray-50","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-3xl","mx-auto"],[1,"text-blue-600","hover:text-blue-800","transition-colors","duration-200","font-medium","block","mb-3","underline",3,"routerLink"],[1,"bg-white","shadow","sm:rounded-lg"],[1,"px-4","py-5","sm:p-6"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[3,"selected","isSearchMode","showSelectedText"],[1,"space-y-6","mt-10",3,"ngSubmit","formGroup"],[3,"disabled"],[1,"grid","grid-cols-1","gap-y-6","gap-x-4","sm:grid-cols-2"],["for","first_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","id","first_name_he","formControlName","first_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","last_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["type","text","id","last_name_he","formControlName","last_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","display_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["type","text","id","display_name_he","formControlName","display_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","nationality_id",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["bindLabel","name","bindValue","id","placeholder","\u05D1\u05D7\u05E8 \u05DE\u05E8\u05E9\u05D9\u05DE\u05D4","formControlName","nationality_id",1,"w-full","mt-1","shadow-sm",3,"items","searchable","clearable"],[1,"flex","justify-end","mt-18"],["type","submit",1,"flex","items-center","gap-2","bg-blue-800","px-6","py-2","rounded-xl","text-white","font-bold","hover:bg-blue-600","cursor-pointer","text-lg","disabled:opacity-75",3,"disabled"],["class","h-5 w-5 animate-spin text-white","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","width","18","height","18",4,"ngIf"],[1,"text-red-500","text-xs"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","width","18","height","18",1,"h-5","w-5","animate-spin","text-white"],["cx","12","cy","12","r","10","stroke","white","stroke-width","4",1,"opacity-25"],["fill","white","d","M4 12a8 8 0 018-8v8H4z",1,"opacity-75"]],template:function(e,o){e&1&&(a(0,"div",0)(1,"div",1)(2,"a",2),m(3,"\u05D7\u05D9\u05E4\u05D5\u05E9 \u05DE\u05E9\u05D7\u05E7\u05D9\u05DD"),i(),a(4,"div",3)(5,"div",4)(6,"h2",5),m(7,"\u05E2\u05E8\u05D5\u05DA \u05E9\u05D7\u05E7\u05DF"),i(),a(8,"app-autocomplete",6),h("selected",function(H){return o.onPlayerSelected(H)}),i(),a(9,"form",7),h("ngSubmit",function(){return o.onSubmit()}),a(10,"fieldset",8)(11,"div",9)(12,"div")(13,"label",10),m(14," \u05E9\u05DD \u05E4\u05E8\u05D8\u05D9 "),u(15,J,2,1,"span",11),i(),d(16,"input",12),i(),a(17,"div")(18,"label",13),m(19," \u05E9\u05DD \u05DE\u05E9\u05E4\u05D7\u05D4 "),u(20,K,2,1,"span",11),i(),d(21,"input",14),i(),a(22,"div")(23,"label",15),m(24," \u05E9\u05DD \u05EA\u05E6\u05D5\u05D2\u05D4 "),u(25,W,2,1,"span",11),i(),d(26,"input",16),i(),a(27,"div")(28,"label",17),m(29," \u05DC\u05D0\u05D5\u05DD "),u(30,X,2,1,"span",11),i(),d(31,"ng-select",18),i()(),a(32,"div",19)(33,"button",20),m(34," \u05E9\u05DE\u05D5\u05E8 \u05E9\u05D7\u05E7\u05DF "),u(35,Y,3,0,"svg",21),i()()()()()()()()),e&2&&(n(2),l("routerLink",w(14,U,o.environment.adminPath.replace("/",""))),n(6),l("isSearchMode",!0)("showSelectedText",!0),n(),l("formGroup",o.playerForm),n(),l("disabled",!o.selectedPlayer),n(5),l("ngIf",o.getFormControlError("first_name_he")),n(5),l("ngIf",o.getFormControlError("last_name_he")),n(5),l("ngIf",o.getFormControlError("display_name_he")),n(5),l("ngIf",o.getFormControlError("nationality_id")),n(),l("items",o.countries)("searchable",!0)("clearable",!1),n(2),l("disabled",o.submitting),n(2),l("ngIf",o.submitting))},dependencies:[P,F,G,k,A,N,T,L,V,M,R,Q,g,I],encapsulation:2})};export{z as EditPlayerComponent};
