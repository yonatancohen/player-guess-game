import{a as L,b as Q}from"./chunk-DD3MQACI.js";import{b as g,c as B}from"./chunk-7X2E3HLW.js";import{a as O}from"./chunk-NCL6GUBF.js";import{b as q}from"./chunk-CXJZMDBI.js";import{C as M,D as V,G as k,H as j,I as G,q as P,s as I,t as s,u as A,v as N,z as T}from"./chunk-GIISJU3V.js";import"./chunk-UISL6Y2D.js";import{Fb as o,Gb as i,Hb as u,Hc as D,Nb as h,Nc as F,Ob as p,Tb as C,Ub as S,Vb as w,Xb as m,Zb as c,ab as n,g as x,gb as y,h as b,lb as E,qb as d,sa as v,x as _,xb as l}from"./chunk-WWCT2R5L.js";function H(r,t){if(r&1&&(o(0,"span",21),m(1),i()),r&2){let e=p();n(),c(" ",e.getFormControlError("first_name_he")," ")}}function U(r,t){if(r&1&&(o(0,"span",21),m(1),i()),r&2){let e=p();n(),c(" ",e.getFormControlError("last_name_he")," ")}}function J(r,t){if(r&1&&(o(0,"span",21),m(1),i()),r&2){let e=p();n(),c(" ",e.getFormControlError("display_name_he")," ")}}function K(r,t){if(r&1&&(o(0,"span",21),m(1),i()),r&2){let e=p();n(),c(" ",e.getFormControlError("nationality_id")," ")}}function W(r,t){r&1&&(v(),o(0,"svg",22),u(1,"circle",23)(2,"path",24),i())}var R=class r{constructor(t,e,a){this.adminService=t;this.fb=e;this.toastrService=a;this.playerForm=this.fb.group({first_name_he:[null,[s.required,s.minLength(2)]],last_name_he:[null,[s.required,s.minLength(2)]],display_name_he:[null,[s.required,s.minLength(2)]],nationality_id:[null,s.required]})}subs=new b;autoCompleteComponent;countries=[];selectedPlayer;submitting=!1;environment=P;playerForm;ngOnInit(){this.subs.add(this.adminService.getCountries().subscribe(t=>this.countries=t))}ngOnDestroy(){this.subs.unsubscribe()}onPlayerSelected(t){return x(this,null,function*(){this.selectedPlayer=t;let e=yield _(this.adminService.getPlayer(t.id));this.playerForm.patchValue(e)})}getFormControlError(t){let e=this.playerForm.get(t);if(e?.invalid&&(e?.dirty||e?.touched)){if(e?.errors?.required)return"\u05E9\u05D3\u05D4 \u05D7\u05D5\u05D1\u05D4";if(e?.errors?.minlength)return"\u05DE\u05D9\u05E0\u05D9\u05DE\u05D5\u05DD 2 \u05EA\u05D5\u05D5\u05D9\u05DD";if(e?.errors?.min)return"\u05DE\u05E1\u05E4\u05E8 \u05D7\u05D9\u05D5\u05D1\u05D9 \u05D1\u05DC\u05D1\u05D3";if(e?.errors?.max)return"\u05DE\u05E1\u05E4\u05E8 \u05E2\u05D3 99"}return""}onSubmit(){if(this.playerForm.markAllAsTouched(),this.playerForm.valid&&this.selectedPlayer){this.submitting=!0;let t=this.playerForm.value;this.adminService.updatePlayer(this.selectedPlayer.id,t).subscribe({next:()=>{this.submitting=!1,this.toastrService.success("\u05D4\u05E9\u05D7\u05E7\u05DF \u05E2\u05D5\u05D3\u05DB\u05DF \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4"),this.playerForm.reset(),this.playerForm.markAsPristine(),this.playerForm.markAsUntouched(),this.playerForm.updateValueAndValidity(),this.autoCompleteComponent.resetSelection(),this.selectedPlayer=void 0},error:()=>{this.submitting=!1,this.toastrService.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E2\u05D3\u05DB\u05D5\u05DF \u05D4\u05E9\u05D7\u05E7\u05DF")}})}}static \u0275fac=function(e){return new(e||r)(y(q),y(k),y(B))};static \u0275cmp=E({type:r,selectors:[["app-edit-player"]],viewQuery:function(e,a){if(e&1&&C(g,5),e&2){let f;S(f=w())&&(a.autoCompleteComponent=f.first)}},decls:35,vars:13,consts:[[1,"min-h-screen","bg-gray-50","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-3xl","mx-auto"],[1,"bg-white","shadow","sm:rounded-lg"],[1,"px-4","py-5","sm:p-6"],[1,"text-2xl","font-bold","text-gray-900","mb-6"],[3,"selected","isSearchMode","showSelectedText"],[1,"space-y-6","mt-10",3,"ngSubmit","formGroup"],[3,"disabled"],[1,"grid","grid-cols-1","gap-y-6","gap-x-4","sm:grid-cols-2"],["for","first_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["class","text-red-500 text-xs",4,"ngIf"],["type","text","id","first_name_he","formControlName","first_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","last_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["type","text","id","last_name_he","formControlName","last_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","display_name_he",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["type","text","id","display_name_he","formControlName","display_name_he",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-blue-500","focus:border-blue-500","sm:text-sm"],["for","nationality_id",1,"flex","justify-between","items-center","text-sm","font-medium","text-gray-700"],["bindLabel","name","bindValue","id","placeholder","\u05D1\u05D7\u05E8 \u05DE\u05E8\u05E9\u05D9\u05DE\u05D4","formControlName","nationality_id",1,"w-full","mt-1","shadow-sm",3,"items","searchable","clearable"],[1,"flex","justify-end","mt-18"],["type","submit",1,"flex","items-center","gap-2","bg-blue-800","px-6","py-2","rounded-xl","text-white","font-bold","hover:bg-blue-600","cursor-pointer","text-lg","disabled:opacity-75",3,"disabled"],["class","h-5 w-5 animate-spin text-white","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","width","18","height","18",4,"ngIf"],[1,"text-red-500","text-xs"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","width","18","height","18",1,"h-5","w-5","animate-spin","text-white"],["cx","12","cy","12","r","10","stroke","white","stroke-width","4",1,"opacity-25"],["fill","white","d","M4 12a8 8 0 018-8v8H4z",1,"opacity-75"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1),u(2,"app-admin-menu"),o(3,"div",2)(4,"div",3)(5,"h2",4),m(6,"\u05E2\u05E8\u05D5\u05DA \u05E9\u05D7\u05E7\u05DF"),i(),o(7,"app-autocomplete",5),h("selected",function(z){return a.onPlayerSelected(z)}),i(),o(8,"form",6),h("ngSubmit",function(){return a.onSubmit()}),o(9,"fieldset",7)(10,"div",8)(11,"div")(12,"label",9),m(13," \u05E9\u05DD \u05E4\u05E8\u05D8\u05D9 "),d(14,H,2,1,"span",10),i(),u(15,"input",11),i(),o(16,"div")(17,"label",12),m(18," \u05E9\u05DD \u05DE\u05E9\u05E4\u05D7\u05D4 "),d(19,U,2,1,"span",10),i(),u(20,"input",13),i(),o(21,"div")(22,"label",14),m(23," \u05E9\u05DD \u05EA\u05E6\u05D5\u05D2\u05D4 "),d(24,J,2,1,"span",10),i(),u(25,"input",15),i(),o(26,"div")(27,"label",16),m(28," \u05DC\u05D0\u05D5\u05DD "),d(29,K,2,1,"span",10),i(),u(30,"ng-select",17),i()(),o(31,"div",18)(32,"button",19),m(33," \u05E9\u05DE\u05D5\u05E8 \u05E9\u05D7\u05E7\u05DF "),d(34,W,3,0,"svg",20),i()()()()()()()()),e&2&&(n(7),l("isSearchMode",!0)("showSelectedText",!0),n(),l("formGroup",a.playerForm),n(),l("disabled",!a.selectedPlayer),n(5),l("ngIf",a.getFormControlError("first_name_he")),n(5),l("ngIf",a.getFormControlError("last_name_he")),n(5),l("ngIf",a.getFormControlError("display_name_he")),n(5),l("ngIf",a.getFormControlError("nationality_id")),n(),l("items",a.countries)("searchable",!0)("clearable",!1),n(2),l("disabled",a.submitting),n(2),l("ngIf",a.submitting))},dependencies:[F,D,j,T,I,A,N,G,M,V,Q,L,g,O],encapsulation:2})};export{R as EditPlayerComponent};
